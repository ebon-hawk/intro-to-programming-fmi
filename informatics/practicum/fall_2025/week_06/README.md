# Циклично изпълнение. Видове циклични процеси

### Теоретичен обзор

#### 1. Какво представлява цикълът?

В програмирането често се налага дадена последователност от инструкции да се изпълни **многократно**. Например:

- Повтаряне на съобщение определен брой пъти
- Приемане на вход от потребителя, докато не бъде въведена коректна стойност
- Повтаряне на действие, докато дадено условие не стане вярно

Когато една група оператори се изпълнява **повторяемо**, говорим за цикличен процес.

В реалния свят циклични явления са ежедневните навици (сън - ставане), смяната на сезоните, ритъмът на метроном и др. В програмирането идеята е същата: повтаряме действие, докато има нужда от това.

#### 2. Видове циклични процеси

Когато говорим за цикъл, важно е как се променя състоянието при всяка стъпка на повторение. Според това разграничаваме два основни типа циклични процеси:

| Вид | Основна идея | Как се променят стойностите? | Пример |
|--------------|--------------|--------------|--------------|
| Итеративен цикъл | Извършваме една и съща операция многократно | Стойностите се променят по **един и същи** начин при всяка стъпка | Пресмятане на сума от поредица въведени числа (всяка стъпка добавя число към сумата) |
| Индуктивен цикъл | Всяка следваща стойност зависи от резултата на предишната | Стойностите се променят **според резултата от предишната итерация** | Удвояване на число няколко пъти; пресмятане на поредица Фибоначи |

Итеративен цикъл (стойностите се променят "равномерно", по предварително известен начин):

```c
#include <stdio.h>

int main() {
    int i = 1;
    int sum = 0;

    while (i <= 5) {
        // Add the current value of `i` to the sum
        sum += i;

        // Increment `i` by 1 in each iteration
        ++i;
    }

    printf("%d\n", sum);

    return 0;
}
```

Тук всяка стъпка прави същото - добавя числото и го увеличава с 1.

Индуктивен цикъл (стъпката зависи от резултата на предишната):

```c
#include <stdio.h>

int main() {
    int num = 1;
    int steps = 5;

    while (steps > 0) {
        // Next value depends on the previous one
        num = num * 2;

        // Decrease remaining step count
        --steps;
    }

    printf("%d\n", num);

    return 0;
}
```

Тук не просто повтаряме действие, а **всяка нова стойност зависи от предходната**.

#### 3. Основни оператори за цикъл в C

| Оператор | Тип контрол | Кога се използва? |
|--------------|--------------|--------------|
| `while` | Цикъл с предусловие | Броят повторения не е известен предварително |
| `do-while` | Цикъл с постусловие | Трябва да се изпълни поне веднъж |
| `for` | Цикъл с брояч | Броят повторения е известен |

#### 4. Цикъл с предусловие (`while`)

Синтаксис:

```c
while (condition) {
    // ...
}
```

Условието се проверява **преди** всяка итерация - ако е невярно още в началото, тялото **не се изпълнява** нито веднъж.

#### 5. Оператори `break` и `continue`

| Оператор | Поведение |
|--------------|--------------|
| `break` | Незабавно прекъсва цикъла |
| `continue` | Пропуска текущата итерация и преминава към проверка на условието |

> **Бележка:** Операторът `break` прекратява само най-вътрешния блок, в който се намира. Ако `switch` е вътре в цикъл, `break` ще прекрати само `switch` блока, а не самия цикъл.

#### 6. Безкраен цикъл

Умишлено:

```c
#include <stdio.h>

int main() {
    int number;

    // Intentional endless loop
    while (1) {
        printf("Enter a positive integer: ");

        int result = scanf("%d", &number);

        // Clear input buffer if `scanf` failed
        if (result != 1) {
            printf("Invalid input. Try again.\n");

            // Discard invalid input
            while (getchar() != '\n');

            // Skip rest, ask again
            continue;
        }

        if (number > 0) {
            printf("You entered: %d\n", number);

            // Exit loop on valid input
            break;
        }
        else {
            printf("Number must be positive. Try again.\n");
        }
    }

    return 0;
}
```

По грешка:

```c
#include <stdio.h>

int main() {
    int i = 1;

    while (i <= 10) {
        // Variable `i` never gets updated, so this loop runs indefinitely
        printf("This will print forever!\n");
    }

    return 0;
}
```

Безкраен цикъл е полезен **само** ако има механизъм за контрол (напр. `break` при определено условие). Липсата на такъв води до неправилно поведение на програмата.

#### 7. Цикъл с постусловие (`do-while`)

Синтаксис:

```c
do {
    // ...
} while (condition);
```

Тялото се изпълнява **поне веднъж**, независимо от условието. Подходящ за менюта или операции, които **задължително** трябва да се извършат поне веднъж.

Примерно меню:

```c
#define _CRT_SECURE_NO_WARNINGS

#include <stdio.h>

int main() {
    int choice;

    do {
        printf("1. Load Game\n2. Quit\n");
        printf("Enter your choice: ");

        if (scanf("%d", &choice) != 1) {
            int ch;

            while ((ch = getchar()) != '\n' && ch != EOF);

            // Reset to stay in loop
            choice = -1;

            printf("Invalid input. Try again.\n");

            continue;
        }

        switch (choice) {
        case 1:
            printf("Loading...\n"); break;
        case 2:
            printf("Quitting...\n"); break;
        default:
            printf("Invalid input. Try again.\n"); break;
        }
    } while (choice != 2);

    return 0;
}
```

#### 8. Цикъл с брояч (`for`)

Цикълът `for` е удобен начин за повторение на блок код, когато знаем колко пъти трябва да се изпълни. Той се състои от три основни части:

- **Инициализация:** Задаваме начална стойност на брояча
- **Условие:** Проверява се дали цикълът трябва да продължи
- **Корекция (актуализация):** Променяме стойността на брояча след всяка итерация

Синтаксис:

```c
for (initialization; condition; update) {
    // ...
}
```

Пример:

```c
for (int i = 1; i <= 5; ++i) {
    printf("Number: %d\n", i);
}
```

В този пример:

- Инициализацията на брояча `i` започва от 1
- Условието проверява дали `i` е по-малко или равно на 5 (ако е вярно, цикълът продължава)
- След всяка итерация броячът се увеличава с 1

Особени случаи:

| Случай | Пример | Обяснение |
|--------------|--------------|--------------|
| Празна инициализация | `for (; i < 10; ++i)` | Инициализираме `i` преди цикъла |
| Празна корекция | `for (i = 0; i < 10;)` | Променяме `i` вътре в тялото |
| Празно условие | `for(;;)` | Безкраен цикъл |

#### 9. Еквивалентност на `for` и `while`

Цикълът `for` е просто по-компактен начин да напишем цикъл `while`, като инициализацията, условието и корекцията са обединени в едно.

```c
for (int i = 0; i < 10; ++i) {
    printf("i = %d\n", i);
}
```

Ето същия цикъл, реализиран с помощта на `while`:

```c
int i = 0;

while (i < 10) {
    printf("i = %d\n", i);

    ++i;
}
```

#### 10. `++i` и `i++`

| Израз | Действие | Бележка |
|--------------|--------------|--------------|
| `++i` | Увеличава `i` и връща новата стойност | Понякога по-ефективно |
| `i++` | Връща старата стойност и после увеличава | Във `for` цикъл обикновено разликата е пренебрежима |

---

### Полезни съвети

- Ако броят повторения е известен предварително, използвайте `for`
- Ако броят повторения е неизвестен и условието се проверява **преди** всяка итерация, използвайте `while`
- Ако цикълът трябва да се изпълни поне веднъж и условието се проверява **след** всяка итерация, използвайте `do-while`

---

### Допълнителни ресурси

- [CoreDumped: Interactive CPU Execution Simulator](https://tinycpu.com/coredumped)
- [Interactive C Loop Execution Simulator](https://pythontutor.com/visualize.html#mode=edit)