# Елементи на програмата и етапи на обработката ѝ

**Цел:** Да се разгледат елементите на една C програма и стъпките, през които минава кодът - от изходния файл до изпълнимия продукт.

> **Бележка:** Не очакваме на този етап студентите да разбират в дълбочина всички стъпки от компилационния процес. Това е само начално демонстрационно упражнение. С времето и с натрупването на опит тези понятия ще станат по-ясни.

---

### Задача 1 → Конфигуриране на GCC

**Какво е GCC?**

GCC (GNU Compiler Collection) е софтуерен пакет с отворен код, който включва компилатори за различни програмни езици. Първоначално е създаден за езика C, но днес поддържа и Ada, C++, Fortran, Go, Objective-C и други. Основната му задача е да **превежда изходния код** (например `hello_world.c`) в **машинен код** - инструкции, които процесорът може да изпълни.

Преди да започнем, проверете дали `gcc` е наличен и коя версия е инсталирана със следната команда:

```bash
gcc --version
```

Примери за инсталация (ако липсва):

- **Debian/Ubuntu:** `sudo apt install build-essential`
- **Fedora:** `sudo dnf install gcc gcc-c++`
- **Windows:** Инсталирайте MinGW-w64 (или използвайте WSL)

### Задача 2 → Настройка на IDE

**Какво е IDE?**

IDE (Integrated Development Environment) е интегрирана среда за разработка, която обединява всички необходими инструменти за дебъгване, изпълнение, компилиране и писане на програмен код на едно място.

Основни компоненти:

- **Текстов редактор:** За писане и редактиране на програмния код
- **Компилатор или интерпретатор:** Инструмент, който превежда написания код на машинен език или го изпълнява директно
- **Дебъгер:** За проследяване на изпълнението на програмата стъпка по стъпка и анализ на поведението ѝ
- **Инструменти за автоматизация:** За бързо изграждане и компилиране на проекта

> **Бележка:** Дори ако работите с IDE, е препоръчително поне веднъж да компилирате и стартирате изходния код ръчно чрез терминал. Това позволява по-добро разбиране на ролята на препроцесора, компилатора и линкера в хода на превръщане на кода в изпълнима програма.

Препоръчва се използването на едно от следните IDE-та:

- **CLion:** Linux, Windows, macOS
- **Code::Blocks:** Linux, Windows, macOS
- **Visual Studio:** Windows

### Задача 3 → Hello, World!

Създайте нов проект в IDE, добавете `hello_world.c` (със съдържанието по-долу), компилирайте и стартирайте програмата.

```c
// Header file for input & output functions
#include <stdio.h>

// Entry point for program execution
int main() {
    // Output a string to the console
    printf("Hello, World!");

    // Indicate successful termination
    return 0;
}
```

### Задача 4 → Ръчна компилация и разглеждане на междинните файлове

В тази задача ще използваме кода от `hello_world.c`, създаден в *Задача 3*. Ще го компилираме стъпка по стъпка, за да видим как се генерират различните междинни файлове. След изпълнението на всяка команда, можете да отворите новосъздадения файл чрез който и да е текстов редактор (например `Notepad++`) и да разгледате съдържанието му.

#### I. Препроцесиране

```bash
gcc hello_world.c -E -o hello_world.i
```

На този етап препроцесорът обработва директивите (редове, които започват с `#` като `#define`, `#ifdef`, `#include`). Всички включени хедър файлове (`stdio.h` и др.) се "разгръщат" и се вмъкват в кода. Макросите се заменят с техните стойности. Резултатът е файлът `hello_world.i`, който представлява чист C код, готов за компилация. Този файл обикновено е много голям, защото съдържа целия код от стандартните библиотеки.

#### II. Генериране на асемблер (по избор, за да видим трансформацията към машинни инструкции)

```bash
gcc hello_world.c -S -o hello_world.s
```

След като препроцесорът е приключил, компилаторът превежда C кода в асемблерен код. Това е ниско ниво, по-близко до машинния език, но все още четимо за човек. Файлът `hello_world.s` съдържа инструкции, които описват как програмата трябва да се изпълнява от процесора. Тази стъпка е полезна за обучение, защото позволява да видим как се трансформира C кодът в инструкции за конкретната архитектура.

#### III. Компилация до обектен файл

```bash
gcc hello_world.c -c -o hello_world.o
```

На този етап асемблерът превежда асемблерния код в машинен код (нули и единици). Получава се обектен файл `hello_world.o` - двоичен файл, който съдържа машинни инструкции. Все още не е готова програма, защото липсват връзките към външните библиотеки (например стандартната библиотека, в която е `printf`).

#### IV. Линкване (свързване) в изпълним файл

```bash
gcc hello_world.o -o hello_world
```

Последната стъпка е линкването. Линкерът събира всички обектни файлове (ако програмата има повече от един `.o` файл) и ги свързва с нужните библиотеки. Например, `printf` не е дефиниран в нашия код, а се намира в стандартната библиотека, и линкерът добавя необходимите връзки. Резултатът е изпълним файл `hello_world`, който вече може да бъде стартиран от операционната система.